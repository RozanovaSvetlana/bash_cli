# Диаграмма классов

# Диаграмма состояний

# Описание

## Input
Построчный ввод поступающий в программу.
1. Команда или пайп (строка).
2. Ввод во время исполнения команды (последовательность строк).

## Lexer
Принимает строку. Разбивает её на отдельные токены (токен - команда с аргументами) по '|', если этот символ не находится в кавычках.

Проверяет, что токены не пустые, в каждом токене у каждой внешней открывающей кавычки есть закрывающая и вся строка не оканчивается пайпом `|`.
Иначе выводит ошибку и ждет следующего ввода пользователя.

Выход - массив токенов (строк команд с аргументами).

## Parameter expansion
Принимает массив токенов.

Осуществляет подстановку для каждого `$var` во всех токенах, если он находится не в одинарных кавычках `'_'`,
смотря на его значение из соответствующего словаря `__variables` в `Environment`.

Если переменная не найдена в `Environment`, то выполняется пустая подстановка.

Выход - массив токенов с выполненными подстановками. 

## Parser
Принимает массив токенов с выполенными подстановками.

Разбивает каждый токен на слова - последовательность символов без пробельных символов или последовательность символов,
заключённая в кавычки (кавычки убираются). \
Если в первом слове встречается знак присваивания `=`, то все,
что слева от начала команды до знака `=` - первый аргумент, а все, что справа от знака `=` до пробела или конца команды - второй аргумент.
Следующие слова токена - отдельные аргументы. 
Таким образом, первое слово со знаком `=` делится на три слова. В остальных случаях первое слово принимается за имя выполняемой команды,
а все остальные слова - ее аргументы. 

Выход - массив структур данных `Command` с полями `<Имя_команды>` и `<Аргументы_команды>`, представленными в виде строк.

## Execution
Принимает массив `Command`.

Для каждого элемента массива последовательно (в порядке выполения команд) ищет имя команды в словаре `__commands` в `Environment` и вызывает
соответствующею команду с переданными аргументами. Если команда не была найдена, то пытается вызвать внешнюю программу с теми же аргументами.

Если не было найдено ни встроенной команды, ни внешней программы, то выводим ошибку пользователю и ждем ввода следующей команды.

## Environment
Словарь `__variables`: `<Имя_переменной>` -> `<Значение переменной>` (строка) \
Словарь `__commmands`: `<Имя_команды>` -> `<Объект/функция/указатель/идентификатор для вызова команды>` \
Результат выполения последней команды и ее код возврата 

## IOService
Представляет собой прослойку для взаимодействия консоли и выполняемых программ с пользователем. \
Дает доступ к потокам ввода/вывода

## Output
Вывод консоли

## Error handler
Обрабатывает ошибки выполнения консоли, команд и программ.
Может осуществлять логгирование.
